<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Cross Site-Collection Requests - gd-sprest</title>
<meta name="description" content="An easy way to develop solutions for SharePoint 2013+/Online environments. ">


  <meta name="author" content="Gunjan Datta">


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="gd-sprest">
<meta property="og:title" content="Cross Site-Collection Requests">
<meta property="og:url" content="http://localhost:4000/topics/cross-sc/">


  <meta property="og:description" content="An easy way to develop solutions for SharePoint 2013+/Online environments. ">











  

  


<link rel="canonical" href="http://localhost:4000/topics/cross-sc/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Dattabase",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="OQUBqgGhFiepr6bOALJ18e1GG6ti7E3ZGyDzAAM9yos" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="gd-sprest Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          gd-sprest
          <span class="site-subtitle">SharePoint REST Framework</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/getting-started">Getting Started</a>
            </li><li class="masthead__menu-item">
              <a href="/examples">Code Examples</a>
            </li><li class="masthead__menu-item">
              <a href="/dev">Dev Docs</a>
            </li><li class="masthead__menu-item">
              <a href="/topics">Dev Topics</a>
            </li><li class="masthead__menu-item">
              <a href="/api">REST API</a>
            </li><li class="masthead__menu-item">
              <a href="/extras">Framework Docs</a>
            </li><li class="masthead__menu-item">
              <a href="/blog">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/docs/sprest/globals.html">Library Docs</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/gunjandatta/sprest">GitHub</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  <div class="sidebar sticky">
    <nav class="nav__list">
        
        <input id="ac-toc" name="accordion-toc" type="checkbox" />
        <label for="ac-toc">Toggle Menu</label>
        <ul class="nav__items">
            <li>
                <a href=".." class="nav__sub-title">Back</a>
            </li>

            <!-- Autogenerate from Category -->
            
        </ul>

        <!-- Autogenerate from Page -->
        <ul class="nav__items">
  <li><a href="#domain-limitation" class="nav__sub-title">Domain Limitation</a></li>
  <li><a href="#get-vs-post-requests" class="nav__sub-title">GET vs POST Requests</a></li>
  <li><a href="#context-information" class="nav__sub-title">Context Information</a>
    <ul>
      <li><a href="#code-examples" class="nav__sub-title">Code Examples</a></li>
    </ul>
  </li>
</ul>

    </nav>
</div>

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Cross Site-Collection Requests">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Cross Site-Collection Requests
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>When making requests to other site collections, it’s important to note that GET requests will work without any issues. When making a POST request, the request digest must be provided in order for the request to be completed. The <a href="/topics/context-info">ContextInfo</a> class contains a helper method for getting this information.</p>

<h2 id="domain-limitation">Domain Limitation</h2>

<p>In order to use the REST api against other site collections, the domain <strong>MUST</strong> be the same. The only exception is an app web, where the REST api is allowed to make requests from the app domain to the SharePoint domain.</p>

<h2 id="get-vs-post-requests">GET vs POST Requests</h2>

<p>If you are performing a GET request against a different site collection, you don’t need to specify the request digest. If you try to execute a POST request against a different site collection, you will most likely get a security error.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The security validation for this page is invalid and might be corrupted.
Please use your web browser's Back button to try your operation again.
</code></pre></div></div>
<p>The “Request Digest” comes from the “SharePoint:FormDigest” component available on SharePoint pages. The element containing this value can be retrieved by doing the following:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">"</span><span class="s2">#__REQUESTDIGEST</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span>
</code></pre></div></div>

<p>If you are executing a POST request to a different site collection, we will need to get the context information of the target web first. Below is an example of getting the list information using CAML query on the root web.</p>

<h2 id="context-information">Context Information</h2>

<p>The <a href="/topics/context-info">Context Information</a> contains the <strong>getWeb</strong> method, which will return the request digest of the target web. The request digest value will allow us to execute POST requests against the target web.</p>

<h3 id="code-examples">Code Examples</h3>

<h4 id="query-listlibrary-in-the-root-web-using-caml">Query List/Library in the root web using CAML</h4>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ContextInfo</span><span class="p">,</span> <span class="nx">Web</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">gd-sprest</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Get the context information of the root web</span>
<span class="nx">ContextInfo</span><span class="p">.</span><span class="nx">getWeb</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">).</span><span class="nx">execute</span><span class="p">((</span><span class="nx">contextInfo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Get the root web</span>
    <span class="nx">Web</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span> <span class="na">requestDigest</span><span class="p">:</span> <span class="nx">contextInfo</span><span class="p">.</span><span class="nx">GetContextWebInformation</span><span class="p">.</span><span class="nx">FormDigestValue</span> <span class="p">})</span>
        <span class="c1">// Get the 'Site Assets' library</span>
        <span class="p">.</span><span class="nx">Lists</span><span class="p">(</span><span class="dl">"</span><span class="s2">Site Assets</span><span class="dl">"</span><span class="p">)</span>
        <span class="c1">// Query for the items</span>
        <span class="p">.</span><span class="nx">getItemsByQuery</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;Query&gt;&lt;OrderBy&gt;&lt;FieldRef Name='ID' /&gt;&lt;/OrderBy&gt;&lt;/Query&gt;</span><span class="dl">"</span><span class="p">)</span>
        <span class="c1">// Execute the request</span>
        <span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">items</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="c1">// Parse the items</span>
            <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">items</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">items</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Cross+Site-Collection+Requests%20http%3A%2F%2Flocalhost%3A4000%2Ftopics%2Fcross-sc%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Ftopics%2Fcross-sc%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Ftopics%2Fcross-sc%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Dattabase. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
