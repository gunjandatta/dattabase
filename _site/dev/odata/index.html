<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>OData - gd-sprest</title>
<meta name="description" content="An easy way to develop solutions for SharePoint 2013+/Online environments. ">


  <meta name="author" content="Gunjan Datta">


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="gd-sprest">
<meta property="og:title" content="OData">
<meta property="og:url" content="http://localhost:4000/dev/odata/">


  <meta property="og:description" content="An easy way to develop solutions for SharePoint 2013+/Online environments. ">











  

  


<link rel="canonical" href="http://localhost:4000/dev/odata/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Dattabase",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="OQUBqgGhFiepr6bOALJ18e1GG6ti7E3ZGyDzAAM9yos" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="gd-sprest Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          gd-sprest
          <span class="site-subtitle">SharePoint REST Framework</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/getting-started">Getting Started</a>
            </li><li class="masthead__menu-item">
              <a href="/examples">Code Examples</a>
            </li><li class="masthead__menu-item">
              <a href="/dev">Dev Docs</a>
            </li><li class="masthead__menu-item">
              <a href="/topics">Dev Topics</a>
            </li><li class="masthead__menu-item">
              <a href="/api">REST API</a>
            </li><li class="masthead__menu-item">
              <a href="/extras">Framework Docs</a>
            </li><li class="masthead__menu-item">
              <a href="/blog">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/docs/sprest/globals.html">Library Docs</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/gunjandatta/sprest">GitHub</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  <div class="sidebar sticky">
    <nav class="nav__list">
        
        <input id="ac-toc" name="accordion-toc" type="checkbox" />
        <label for="ac-toc">Toggle Menu</label>
        <ul class="nav__items">
            <li>
                <a href=".." class="nav__sub-title">Back</a>
            </li>

            <!-- Autogenerate from Category -->
            
        </ul>

        <!-- Autogenerate from Page -->
        <ul class="nav__items">
  <li><a href="#odata-requests" class="nav__sub-title">OData Requests</a>
    <ul>
      <li><a href="#query-properties" class="nav__sub-title">Query Properties</a></li>
    </ul>
  </li>
  <li><a href="#code-examples" class="nav__sub-title">Code Examples</a>
    <ul>
      <li><a href="#javascript" class="nav__sub-title">JavaScript</a></li>
      <li><a href="#typescript" class="nav__sub-title">TypeScript</a></li>
    </ul>
  </li>
</ul>

    </nav>
</div>

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="OData">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">OData
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="odata-requests">OData Requests</h2>

<p>The REST API allows for OData requests to be made to each request. This will allow us to expand collections of the target object, to help reduce the number of requests made to the server.</p>

<h3 id="query-properties">Query Properties</h3>

<ul>
  <li>Custom: <em>string</em>
    <ul>
      <li>Appended to the querystring</li>
    </ul>
  </li>
  <li>Expand: <em>Array&lt;string&gt;</em>
    <ul>
      <li>The properties to expand</li>
    </ul>
  </li>
  <li>Filter: <em>string</em>
    <ul>
      <li>The filter</li>
    </ul>
  </li>
  <li>GetAllItems: <em>boolean</em>
    <ul>
      <li>Flag to get all items (False by default)</li>
      <li>Use this flag to get past the 5k limit</li>
      <li>The result is still limited to the threshold defined for the web application</li>
    </ul>
  </li>
  <li>OrderBy: <em>Array&lt;string&gt;</em>
    <ul>
      <li>An array of properties to order by</li>
      <li>Add “ desc” to the property, to reverse the order</li>
    </ul>
  </li>
  <li>Select: <em>Array&lt;string&gt;</em>
    <ul>
      <li>An array of properties to be selected</li>
    </ul>
  </li>
  <li>Skip: <em>number</em>
    <ul>
      <li>The number of results to skip</li>
    </ul>
  </li>
  <li>Top: <em>number</em>
    <ul>
      <li>The max number of results to return</li>
      <li>5000 is the max limit</li>
      <li>Setting the “GetAllItems” flag will get past the 5k limit</li>
    </ul>
  </li>
</ul>

<h2 id="code-examples">Code Examples</h2>

<h3 id="javascript">JavaScript</h3>

<h4 id="reference-the-library">Reference the library</h4>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">$REST</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">gd-sprest</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="get-the-web-expanding-the-field-lists-and-root-folder">Get the web, expanding the field, lists and root folder</h4>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Get the current web</span>
<span class="nx">$REST</span><span class="p">.</span><span class="nx">Web</span><span class="p">()</span>
    <span class="c1">// Expand the fields, lists and root folder properties</span>
    <span class="p">.</span><span class="nx">query</span><span class="p">({</span>
        <span class="na">Expand</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Fields</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Lists</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">RootFolder</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="c1">// Execute the request</span>
    <span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">web</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">fields</span> <span class="o">=</span> <span class="nx">web</span><span class="p">.</span><span class="nx">Fields</span><span class="p">.</span><span class="nx">results</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">lists</span> <span class="o">=</span> <span class="nx">web</span><span class="p">.</span><span class="nx">Lists</span><span class="p">.</span><span class="nx">results</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">rootFolder</span> <span class="o">=</span> <span class="nx">web</span><span class="p">.</span><span class="nx">RootFolder</span><span class="p">;</span>
    <span class="p">});</span>
</code></pre></div></div>

<h4 id="query-for-picture-libraries-including-their-items">Query for picture libraries, including their items</h4>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Get the current web</span>
<span class="nx">$REST</span><span class="p">.</span><span class="nx">Web</span><span class="p">()</span>
    <span class="c1">// Get the lists</span>
    <span class="p">.</span><span class="nx">Lists</span><span class="p">()</span>
    <span class="c1">// Query for the picture libraries, including the items</span>
    <span class="p">.</span><span class="nx">query</span><span class="p">({</span>
        <span class="na">Expand</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Items</span><span class="dl">"</span><span class="p">],</span>
        <span class="na">Filter</span><span class="p">:</span> <span class="dl">"</span><span class="s2">BaseTemplate eq 109</span><span class="dl">"</span>
    <span class="p">})</span>
    <span class="c1">// Execute the request</span>
    <span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">lists</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Parse the lists</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">lists</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">;)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">Items</span><span class="p">.</span><span class="nx">results</span><span class="p">;</span>

            <span class="c1">// Code goes here</span>
        <span class="p">}</span>
    <span class="p">});</span>
</code></pre></div></div>

<h3 id="typescript">TypeScript</h3>

<h4 id="reference-the-library-1">Reference the library</h4>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Web</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">gd-sprest</span><span class="dl">"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="get-the-web-expanding-the-field-lists-and-root-folder-1">Get the web, expanding the field, lists and root folder</h4>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Get the current web</span>
<span class="nx">Web</span><span class="p">()</span>
    <span class="c1">// Expand the fields, lists and root folder properties</span>
    <span class="p">.</span><span class="nx">query</span><span class="p">({</span>
        <span class="na">Expand</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Fields</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Lists</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">RootFolder</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="c1">// Execute the request</span>
    <span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">web</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">fields</span> <span class="o">=</span> <span class="nx">web</span><span class="p">.</span><span class="nx">Fields</span><span class="p">.</span><span class="nx">results</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">lists</span> <span class="o">=</span> <span class="nx">web</span><span class="p">.</span><span class="nx">Lists</span><span class="p">.</span><span class="nx">results</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">rootFolder</span> <span class="o">=</span> <span class="nx">web</span><span class="p">.</span><span class="nx">RootFolder</span><span class="p">;</span>
    <span class="p">});</span>
</code></pre></div></div>

<h4 id="query-for-picture-libraries-including-their-items-1">Query for picture libraries, including their items</h4>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Get the current web</span>
<span class="nx">Web</span><span class="p">()</span>
    <span class="c1">// Get the lists</span>
    <span class="p">.</span><span class="nx">Lists</span><span class="p">()</span>
    <span class="c1">// Query for the picture libraries, including the items</span>
    <span class="p">.</span><span class="nx">query</span><span class="p">({</span>
        <span class="na">Expand</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Items</span><span class="dl">"</span><span class="p">],</span>
        <span class="na">Filter</span><span class="p">:</span> <span class="dl">"</span><span class="s2">BaseTemplate eq 109</span><span class="dl">"</span>
    <span class="p">})</span>
    <span class="c1">// Execute the request</span>
    <span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">lists</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">// Parse the lists</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">lists</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">;)</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">list</span> <span class="o">=</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="kd">let</span> <span class="nx">items</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">Items</span><span class="p">.</span><span class="nx">results</span><span class="p">;</span>

            <span class="c1">// Code goes here</span>
        <span class="p">}</span>
    <span class="p">});</span>
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=OData%20http%3A%2F%2Flocalhost%3A4000%2Fdev%2Fodata%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdev%2Fodata%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fdev%2Fodata%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Dattabase. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
